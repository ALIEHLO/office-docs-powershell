### YamlMime:PowershellCmdlet
summary: |-
  This cmdlet is available only in Security & Compliance Center PowerShell. For more information, see [Security & Compliance Center PowerShell](https://docs.microsoft.com/powershell/exchange/scc-powershell).

  Use the Set-AppRetentionCompliancePolicy to modify app retention compliance policies.

  For information about the parameter sets in the Syntax section below, see [Exchange cmdlet syntax](https://docs.microsoft.com/powershell/exchange/exchange-cmdlet-syntax).
module: ExchangePowerShell
notes: ""
inputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: ""
outputs:
- name: <xref href=" " data-throw-if-not-resolved="False" />
  description: ""
syntaxes:
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-AddExchangeLocation <MultiValuedProperty>]

   [-AddExchangeLocationException <MultiValuedProperty>]

   [-AddModernGroupLocation <MultiValuedProperty>]

   [-AddModernGroupLocationException <MultiValuedProperty>]

   [-Applications <String[]>]

   [-Comment <String>]

   [-Confirm]

   [-Enabled <Boolean>]

   [-Force]

   [-RemoveExchangeLocation <MultiValuedProperty>]

   [-RemoveExchangeLocationException <MultiValuedProperty>]

   [-RemoveModernGroupLocation <MultiValuedProperty>]

   [-RemoveModernGroupLocationException <MultiValuedProperty>]

   [-RestrictiveRetention <Boolean>]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-AddAdaptiveScopeLocation <MultiValuedProperty>]

   [-Applications <String[]>]

   [-Comment <String>]

   [-Confirm]

   [-Enabled <Boolean>]

   [-Force]

   [-RemoveAdaptiveScopeLocation <MultiValuedProperty>]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-Comment <String>]

   [-Confirm]

   [-Enabled <Boolean>]

   [-Force]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-Confirm]

   [-Force]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-Confirm]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-Confirm]

   [-WhatIf]

   [<CommonParameters>]
- >-
  Set-AppRetentionCompliancePolicy [-Identity] <PolicyIdParameter>

   [-Confirm]

   [-RetryDistribution]

   [-WhatIf]

   [<CommonParameters>]
examples:
- title: Example 1
  code: |-
    Set-AppRetentionCompliancePolicy Identity "Regulation 563 Marketing" -Applications "User:MicrosoftTeams","Group:MicrosoftTeams,Yammer" -AddExchangeLocation "Scott Smith" -Comment "Added new counsel, 9/9/21"
  description: |-
    This example adds a new user to the existing static scope retention policy named Regulation 563 Marketing that's set up for Teams private channels messages.
  summary: ""
parameters:
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: AddAdaptiveScopeLocation
  description: |+
    {{ Fill AddAdaptiveScopeLocation Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: AddExchangeLocation
  description: |+
    {{ Fill AddExchangeLocation Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: AddExchangeLocationException
  description: |+
    {{ Fill AddExchangeLocationException Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: AddModernGroupLocation
  description: |+
    {{ Fill AddModernGroupLocation Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: AddModernGroupLocationException
  description: |+
    {{ Fill AddModernGroupLocationException Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: Applications
  description: |+
    {{ Fill Applications Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Comment
  description: |+
    The Comment parameter specifies an optional comment. If you specify a value that contains spaces, enclose the value in quotation marks ("), for example: "This is an admin note".

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Confirm
  description: |+
    The Confirm switch specifies whether to show or hide the confirmation prompt. How this switch affects the cmdlet depends on if the cmdlet requires confirmation before proceeding.

    - Destructive cmdlets (for example, Remove-\* cmdlets) have a built-in pause that forces you to acknowledge the command before proceeding. For these cmdlets, you can skip the confirmation prompt by using this exact syntax: `-Confirm:$false`.
    - Most other cmdlets (for example, New-\* and Set-\* cmdlets) don't have a built-in pause. For these cmdlets, specifying the Confirm switch without a value introduces a pause that forces you acknowledge the command before proceeding.

  defaultValue: None
  position: Named
  aliases: cf
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: Enabled
  description: |+
    The Enabled parameter enables or disables the policy. Valid values are:

    - $true: The policy is enabled. This is the default value.
    - $false: The policy is disabled.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Force
  description: |+
    The Force switch hides warning or confirmation messages. You don't need to specify a value with this switch.

    You can use this switch to run tasks programmatically where prompting for administrative input is inappropriate.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="PolicyIdParameter" data-throw-if-not-resolved="False" />
  name: Identity
  isRequired: true
  description: |+
    The Identity parameter specifies the app retention compliance policy that you want to modify. You can use any value that uniquely identifies the policy. For example:

    - Name
    - Distinguished name (DN)
    - GUID

  defaultValue: None
  pipelineInput: true
  position: "0"
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: RemoveAdaptiveScopeLocation
  description: |+
    {{ Fill RemoveAdaptiveScopeLocation Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: RemoveExchangeLocation
  description: |+
    {{ Fill RemoveExchangeLocation Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: RemoveExchangeLocationException
  description: |+
    {{ Fill RemoveExchangeLocationException Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: RemoveModernGroupLocation
  description: |+
    {{ Fill RemoveModernGroupLocation Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="MultiValuedProperty" data-throw-if-not-resolved="False" />
  name: RemoveModernGroupLocationException
  description: |+
    {{ Fill RemoveModernGroupLocationException Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="Boolean" data-throw-if-not-resolved="False" />
  name: RestrictiveRetention
  description: |+
    The RestrictiveRetention parameter specifies whether Preservation Lock is enabled for the policy. Valid values are:

    - $true: Preservation Lock is enabled for the policy. No one -- including an administrator -- can turn off the policy or make it less restrictive.
    - $false: Preservation Lock isn't enabled for the policy. This is the default value.

    After a policy has been locked, no one can turn off or disable it, or remove apps from the policy. The only ways that you can modify the policy are by adding apps to it, or extending its duration. A locked policy can be increased or extended, but it can't be reduced, disabled, or turned off.

    Therefore, before you lock a policy, it's critical that you understand your organization's compliance requirements, and that you don't lock a policy until you are certain that it's what you need.

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: RetryDistribution
  isRequired: true
  description: |+
    {{ Fill RetryDistribution Description }}

  defaultValue: None
  position: Named
  aliases: ""
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: WhatIf
  description: |+
    The WhatIf switch doesn't work in Security & Compliance Center PowerShell.

  defaultValue: None
  position: Named
  aliases: wi
  applicable:
  - Security & Compliance Center
  parameterValueGroup: ""
applicable:
- Security & Compliance Center
uid: ExchangePowerShell.Set-AppRetentionCompliancePolicy
name: Set-AppRetentionCompliancePolicy
description: |-
  To use this cmdlet in Security & Compliance Center PowerShell, you need to be assigned permissions. For more information, see [Permissions in the Microsoft 365 compliance center](https://docs.microsoft.com/microsoft-365/compliance/microsoft-365-compliance-center-permissions).
metadata:
  external help file: Microsoft.Exchange.TransportMailflow-Help.xml
  online version: https://docs.microsoft.com/powershell/module/exchange/set-appretentioncompliancepolicy
  applicable: Security & Compliance Center
  title: Set-AppRetentionCompliancePolicy
  schema: 2.0.0
  author: chrisda
  ms.author: chrisda
  ms.reviewer: ""
